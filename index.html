<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple IP Monitor</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center">
  <div class="w-full max-w-sm mx-auto p-6 bg-white rounded-lg shadow-md">
    <h1 class="text-2xl font-semibold text-gray-800 mb-4">Simple IP Monitor</h1>
    <div class="mb-3">
      <h2 class="text-lg font-medium text-gray-700 mb-2">Your Local Device Info</h2>
      <div id="ip-address" class="text-gray-600 mb-2">Unavailable</div>
      <div id="network-type" class="text-gray-600 mb-2">Network Type: Detecting...</div>
      <div id="protocol" class="text-gray-600 mb-2">Protocol: Detecting...</div>
      <div id="last-updated" class="text-gray-400 text-sm">Last Updated: --:--:--</div>
    </div>
    <button id="refresh-btn" class="w-full mt-4 py-2 px-4 bg-blue-500 hover:bg-blue-600 text-white rounded-md focus:outline-none focus:ring-2 focus:ring-blue-300">
      Refresh
    </button>
    <p class="text-xs text-gray-400 mt-4">Only local information can be shown without external APIs.</p>
  </div>
  <script>
    // Detect local IP using WebRTC (works in some browsers)
    function getLocalIP(callback) {
      let ipFound = false;
      let ipResult = "Unavailable";
      let RTCPeerConnection = window.RTCPeerConnection
        || window.mozRTCPeerConnection
        || window.webkitRTCPeerConnection;
      if (!RTCPeerConnection) {
        callback("Unavailable");
        return;
      }
      let pc = new RTCPeerConnection({iceServers:[]});
      let noop = function(){};
      pc.createDataChannel("");
      pc.createOffer().then(sdp => pc.setLocalDescription(sdp, noop, noop));
      pc.onicecandidate = function(ice){
        if (!ice || !ice.candidate || !ice.candidate.candidate) {
          if (!ipFound) callback("Unavailable");
          return;
        }
        let parts = ice.candidate.candidate.split(' ');
        let addr = parts[4];
        if (!ipFound && addr && addr.match(/^(\d{1,3}\.){3}\d{1,3}$/)) {
          ipFound = true;
          ipResult = addr;
          callback(addr);
          pc.close();
        }
      };
      setTimeout(() => { if (!ipFound) callback("Unavailable"); }, 1000);
    }

    function getNetworkType() {
      if (navigator.connection && navigator.connection.type) {
        switch (navigator.connection.type) {
          case 'wifi': return 'WiFi';
          case 'cellular': return 'Mobile Data';
          case 'ethernet': return 'Ethernet';
          case 'wimax': return 'WiMAX';
          case 'none': return 'Offline';
        }
      }
      if (navigator.connection && navigator.connection.effectiveType) {
        // 4g/3g/2g/etc.
        let eType = navigator.connection.effectiveType;
        if (eType === '4g' || eType === '3g' || eType === '2g' || eType === 'slow-2g') {
          return 'Mobile Data';
        }
      }
      if (window.navigator.userAgent.toLowerCase().includes('android')) return 'Mobile Data';
      if (window.navigator.userAgent.toLowerCase().includes('iphone')) return 'Mobile Data';
      return 'Unknown';
    }

    function getProtocol(ip) {
      if (ip === "Unavailable") return "Detecting...";
      if (ip.indexOf(":") > -1) return "IPv6";
      if (ip.match(/^(\d{1,3}\.){3}\d{1,3}$/)) return "IPv4";
      return "Unknown";
    }

    function updateInfo() {
      document.getElementById("ip-address").textContent = "Detecting...";
      document.getElementById("network-type").textContent = "Network Type: Detecting...";
      document.getElementById("protocol").textContent = "Protocol: Detecting...";
      document.getElementById("last-updated").textContent = "Last Updated: " + (new Date()).toLocaleTimeString();
      getLocalIP(function(ip) {
        document.getElementById("ip-address").textContent = ip;
        document.getElementById("protocol").textContent = "Protocol: " + getProtocol(ip);
      });
      let networkType = getNetworkType();
      document.getElementById("network-type").textContent = "Network Type: " + networkType;
    }

    document.getElementById("refresh-btn").onclick = updateInfo;

    // Initial load
    updateInfo();
  </script>
</body>
</html>

